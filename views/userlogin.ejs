<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login Page</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.min.css"
      integrity="sha512-jnSuA4Ss2PkkikSOLtYs8BlYIeeIK1h99ty4YfvRPAlzr377vr3CXDb7sb7eEEBYjDtcYj+AjBH3FLv5uSJuXg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />

    <style rel="stylesheet">
      body {
        min-height: 100vh;
        background: #f2f6f5;
        margin: 0;
        padding: 0;
        overflow-y: hidden;
      }

      .login--area {
        background: #fff;
        display: block;
        margin: auto;
        margin-top: 30px;
        width: 470px;
        height: 460px;
        padding: 2rem 16px 10px 16px;
        border: 1px solid #0c359e;
      }

      form .form-control:focus {
        outline: none;
        box-shadow: none;
      }

      form #captcha {
        width: 100%;
        height: 80px;
        letter-spacing: 6px;
        border: 1px solid #3f73f7;
        background-color: #3e73fa;
        color: #fff;
      }
      form .refresh-captcha{
        width: 40px;
        height: 30px;
        cursor: pointer;
      }

      form .login--btn {
        border-radius: 200px;
        background: #0c359e;
        color: #ffff;
        border: none;
      }

      .msg-for-number,
      .msg.for-captcha{
        color: red;
        font-size: 16px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h2 class="text-center fw-bold mb-2 mt-5">HealthHub</h2>
      <div class="login--area">
        <h4 class="title mb-4 text-center">Login To Continue!</h4>
        <form action="/login" method="post" name="loginForm">
          <div class="form-group mb-2">
            <label for="PhoneNumber" class="fw-bold">Phone Number</label>
            <input
              type="text"
              class="form-control"
              id="number"
              name="phone"
              placeholder="Enter Mobile Number"
              required
            />
            <span class="msg-for-number"></span>
          </div>
          <div class="form-group mb-4">
            <div class="d-flex gap-2 align-items-center">
              <canvas id="captcha"></canvas>
              <div class="refresh-captcha" onclick="createCaptcha()">
                <i class="fa fa-arrows-rotate fs-2"></i>
              </div>
            </div>
          </div>
          <div class="form-group mb-4">
            <input
              type="text"
              class="form-control"
              id="captcha-input"
              placeholder="Write Captcha code"
            />
            <span class="msg-for-captcha"></span>
          </div>
          <button
            type="submit"
            class="px-5 py-2 login--btn form-control"
            id="login"
          >
            Sign In
          </button>
        </form>
      </div>
    </div>

    <script>
      const number = document.getElementById("number");
      const captchaInput = document.getElementById("captcha-input");
      const loginBtn = document.getElementById("login");


      let captchaText = document.getElementById("captcha");
      let ctx = captchaText.getContext("2d");
      ctx.font = "35px Areal";
      ctx.fillStyle = "#fff";

      let captchaStr = "";

      const captchaCode = [
        "A",
        "B",
        "C",
        "D",
        "E",
        "F",
        "G",
        "H",
        "I",
        "J",
        "K",
        "L",
        "M",
        "N",
        "O",
        "P",
        "Q",
        "R",
        "S",
        "T",
        "U",
        "V",
        "W",
        "X",
        "Y",
        "Z",
        "a",
        "b",
        "c",
        "d",
        "e",
        "f",
        "g",
        "h",
        "i",
        "j",
        "k",
        "l",
        "m",
        "n",
        "o",
        "p",
        "q",
        "r",
        "s",
        "t",
        "u",
        "v",
        "w",
        "x",
        "y",
        "z",
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7",
        "8",
        "9",
      ];

      function createCaptcha() {
        let arr = [];

        for (let i = 1; i <= 7; i++) {
          arr.push(captchaCode[Math.floor(Math.random() * captchaCode.length)]);
        }

        captchaStr = arr.join("");

        ctx.clearRect(0, 0, captchaText.width, captchaText.height);
        ctx.fillText(captchaStr, captchaText.width / 4, captchaText.height / 2);
      }

      createCaptcha();

      function isNumber(num) {
        if (!isNaN(num)) {
          if (num.length > 10 || num.length < 10) {
            document.querySelector(".msg-for-number").innerHTML =
              "Please provide a correct number";
              number.style.border = "1px solid red";
              number.focus();
            return false;
          }
        } else {
          document.querySelector(".msg-for-number").innerHTML =
            "Please provide a number";
            number.style.border = "1px solid red";
            number.focus();
          return false;
        }

        return true;
      }

      function isCaptchaValid(value){
        if (value !== captchaStr) {
          document.querySelector(".msg-for-captcha").innerHTML =
            "Incorrect captcha!";
            captchaInput.style.border = "1px solid red";
            return false;
        }

        return true;
      }



      document.forms["loginForm"].addEventListener("submit", (event) => {
        event.preventDefault();

          const validNumber = isNumber(number.value);
          const validCaptcha = isCaptchaValid(captchaInput.value);

        if( validNumber && validCaptcha){
          document.forms["loginForm"].submit();
        }else{
          document.forms["loginForm"].reset();
        }
        
      });
    </script>
  </body>
</html>
